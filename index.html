<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fren Alarm Clock</title>
<style>
  :root {
    --accent: #00d4ff;
    --bg: #0f172a;
  }
  body {
    margin: 0;
    background: var(--bg);
    color: #fff;
    font-family: "Poppins", sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    text-align: center;
    overflow: hidden;
  }
  h1 {
    color: var(--accent);
  }
  button, input {
    font-size: 1rem;
    padding: 8px 12px;
    border-radius: 10px;
    border: none;
    margin: 6px;
    outline: none;
  }
  button {
    background: var(--accent);
    color: #000;
    font-weight: bold;
    cursor: pointer;
  }
  button:hover { opacity: 0.9; }
  .clock { font-size: 3rem; margin: 15px 0; }
  #alarmStatus { color: #9efeff; margin-top: 8px; }
  #alertBox {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(255,255,255,0.9);
    color: #000;
    padding: 20px 30px;
    border-radius: 15px;
    font-size: 1.4rem;
    z-index: 1000;
    box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  }
  body.flash { animation: flash 0.3s alternate infinite; }
  @keyframes flash {
    from { background-color: var(--bg); }
    to { background-color: #ff004c; }
  }
  #bgPreview {
    width: 100%;
    height: 100vh;
    background-size: cover;
    background-position: center;
    position: fixed;
    top: 0;
    left: 0;
    z-index: -1;
  }

  /* ========== PRANK SCREEN ========== */
  #prankScreen {
    position: fixed;
    inset: 0;
    background: #000;
    color: #fff;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: opacity 0.6s ease;
  }
  #prankScreen img {
    max-width: 90%;
    max-height: 80vh;
    border-radius: 12px;
    animation: pop 0.8s ease forwards;
  }
  @keyframes pop {
    0% { transform: scale(0); opacity: 0; }
    70% { transform: scale(1.1); opacity: 1; }
    100% { transform: scale(1); }
  }
</style>
</head>
<body>

<!-- PRANK SCREEN -->
<div id="prankScreen">
  <h2>üòÇ Prank Setup</h2>
  <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏Å‡∏•‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô!</p>
  <input type="file" id="prankImage" accept="image/*"><br>
  <input type="file" id="prankSound" accept="audio/*"><br>
  <button id="startPrank">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏Å‡∏•‡πâ‡∏á‡πÄ‡∏•‡∏¢!</button>
</div>

<!-- BACKGROUND -->
<div id="bgPreview"></div>

<!-- MAIN CLOCK -->
<h1>üï∞ Fren Alarm Clock</h1>
<div class="clock" id="clock">00:00:00</div>

<input type="time" id="alarmTime" />
<button id="setAlarm">‡∏ï‡∏±‡πâ‡∏á‡∏õ‡∏•‡∏∏‡∏Å</button>
<div id="alarmStatus"></div>

<br>
<label>üéô ‡∏≠‡∏±‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô:</label><br>
<button id="startRecord">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏î</button>
<button id="stopRecord" disabled>‡∏´‡∏¢‡∏∏‡∏î</button>
<audio id="recordedAudio" controls style="display:none;"></audio>
<br><br>
<label>üìÇ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á:</label><br>
<input type="file" id="audioUpload" accept="audio/mp3,audio/mpeg,audio/*" />
<br><br>
<label>üñº ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á:</label><br>
<input type="file" id="bgUpload" accept="image/*" />

<div id="alertBox">‚è∞ ‡∏ï‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß Fren! ‚è∞</div>

<script>
const prankScreen = document.getElementById("prankScreen");
const prankImgInput = document.getElementById("prankImage");
const prankSoundInput = document.getElementById("prankSound");
let prankImgURL = null;
let prankSoundURL = null;

document.getElementById("startPrank").onclick = () => {
  if (!prankImgInput.files[0] || !prankSoundInput.files[0]) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞ Fren!");
    return;
  }
  prankImgURL = URL.createObjectURL(prankImgInput.files[0]);
  prankSoundURL = URL.createObjectURL(prankSoundInput.files[0]);
  playPrank();
};

function playPrank() {
  prankScreen.innerHTML = `<img src="${prankImgURL}" alt="prank"><audio id="prankAudio" src="${prankSoundURL}" autoplay></audio>`;
  const audio = document.getElementById("prankAudio");
  audio.play();

  setTimeout(() => {
    prankScreen.style.opacity = "0";
    setTimeout(() => (prankScreen.style.display = "none"), 600);
  }, 10000);
}

// ALARM SYSTEM
const clockEl = document.getElementById("clock");
const alarmInput = document.getElementById("alarmTime");
const statusEl = document.getElementById("alarmStatus");
const alertBox = document.getElementById("alertBox");
const bgPreview = document.getElementById("bgPreview");

let alarmTime = null;
let alarmAudio = null;
let recordingChunks = [];
let mediaRecorder = null;

setInterval(() => {
  const now = new Date();
  const h = String(now.getHours()).padStart(2, "0");
  const m = String(now.getMinutes()).padStart(2, "0");
  const s = String(now.getSeconds()).padStart(2, "0");
  clockEl.textContent = `${h}:${m}:${s}`;
  if (alarmTime && `${h}:${m}` === alarmTime && s === "00") triggerAlarm();
}, 1000);

document.getElementById("setAlarm").addEventListener("click", () => {
  alarmTime = alarmInput.value;
  statusEl.textContent = alarmTime ? `üîî ‡∏ï‡∏±‡πâ‡∏á‡∏õ‡∏•‡∏∏‡∏Å‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà ${alarmTime}` : "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤";
});

function triggerAlarm() {
  document.body.classList.add("flash");
  alertBox.style.display = "block";
  if (alarmAudio) alarmAudio.play();
  else {
    const ctx = new AudioContext();
    const osc = ctx.createOscillator();
    osc.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 2);
  }
  setTimeout(stopAlarm, 10000);
}

function stopAlarm() {
  document.body.classList.remove("flash");
  alertBox.style.display = "none";
  if (alarmAudio) { alarmAudio.pause(); alarmAudio.currentTime = 0; }
}

// RECORD AUDIO
document.getElementById("startRecord").onclick = async () => {
  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  mediaRecorder = new MediaRecorder(stream);
  recordingChunks = [];
  mediaRecorder.start();
  document.getElementById("startRecord").disabled = true;
  document.getElementById("stopRecord").disabled = false;
  mediaRecorder.ondataavailable = (e) => recordingChunks.push(e.data);
  mediaRecorder.onstop = () => {
    const blob = new Blob(recordingChunks, { type: "audio/mp3" });
    const url = URL.createObjectURL(blob);
    const audio = document.getElementById("recordedAudio");
    audio.src = url; audio.style.display = "block";
    alarmAudio = new Audio(url);
  };
};
document.getElementById("stopRecord").onclick = () => {
  if (mediaRecorder && mediaRecorder.state !== "inactive") mediaRecorder.stop();
  document.getElementById("startRecord").disabled = false;
  document.getElementById("stopRecord").disabled = true;
};

// UPLOAD AUDIO
document.getElementById("audioUpload").onchange = (e) => {
  const file = e.target.files[0];
  if (file) alarmAudio = new Audio(URL.createObjectURL(file));
};

// UPLOAD BACKGROUND
document.getElementById("bgUpload").onchange = (e) => {
  const file = e.target.files[0];
  if (file) bgPreview.style.backgroundImage = `url('${URL.createObjectURL(file)}')`;
};
</script>
</body>
</html>
